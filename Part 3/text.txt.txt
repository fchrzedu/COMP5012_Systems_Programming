Code for part3 of COMP5012